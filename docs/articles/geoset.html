<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EIA geosets â€¢ eia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="EIA geosets">
<meta property="og:description" content="eia">
<meta property="og:image" content="https://docs.ropensci.org/eia/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/eia.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/categories.html">Categories</a>
    </li>
    <li>
      <a href="../articles/series.html">Time series</a>
    </li>
    <li>
      <a href="../articles/geoset.html">Geosets</a>
    </li>
    <li>
      <a href="../articles/api.html">API details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/eia">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="geoset_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EIA geosets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/eia/blob/master/vignettes/geoset.Rmd"><code>vignettes/geoset.Rmd</code></a></small>
      <div class="hidden name"><code>geoset.Rmd</code></div>

    </div>

    
    
<div id="time-series-by-region" class="section level2">
<h2 class="hasAnchor">
<a href="#time-series-by-region" class="anchor"></a>Time series by region</h2>
<p>Geosets are metadata structures relating series together. Requesting series using the <code>geoset</code> API endpoint is much the same as requesting series data using the <code>series</code> endpoint. Instead of <code>eia_series</code>, use <code>eia_geoset</code>.</p>
<p>The main difference is that you must provide a geoset ID to <code>id</code> and a <code>region</code> argument. Both may be vectors of multiple series and regions. The function returns the combination of time series datasets and regions that exist. The API will not return all geographic entities associated with a geoset. You are required to specify which region(s) you want and they must be associated with the given geoset ID.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/eia">eia</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># eia_set_key("yourkey") # set API key if not already set globally</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="st">"ELEC.GEN.ALL-99.A"</span>
<span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"USA-CA"</span>, <span class="st">"USA-NY"</span><span class="op">)</span>
<span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eia_geoset.html">eia_geoset</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">region</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 11</span>
<span class="co">#&gt;   geoset_id       setname                             f     units            series_id        name                                       region latlon start end   data        </span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;                               &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;                                      &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;list&gt;      </span>
<span class="co">#&gt; 1 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megawa~ ELEC.GEN.ALL-CA~ Net generation : all fuels : California :~ USA-CA &lt;NA&gt;   2001  2019  &lt;tibble [3 ~</span></code></pre></div>
</div>
<div id="groups-of-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#groups-of-regions" class="anchor"></a>Groups of regions</h2>
<p>If you want data for all fifty states for example, you can set <code>region = "USA"</code>; you do not need to make a vector of all fifty state IDs. However, if you want certain region subsets, there are other options besides making a vector of these values. For example, the <code>eia_geoset</code> accepts shorthand descriptions of specific, popular subsets of states; so popular in fact that their labels ship with R itself in the <code>datasts</code> package.</p>
<p>You can provide simple state abbreviations (without the <code>USA-</code> prefix), state names, and more to the point, US Census regions and divisions. These are two hierarchical sets of US states.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">state.abb</span>, <span class="va">state.name</span>, <span class="va">state.region</span>, <span class="va">state.division</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 50 x 4</span>
<span class="co">#&gt;    state.abb state.name  state.region state.division    </span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;       &lt;fct&gt;        &lt;fct&gt;             </span>
<span class="co">#&gt;  1 AL        Alabama     South        East South Central</span>
<span class="co">#&gt;  2 AK        Alaska      West         Pacific           </span>
<span class="co">#&gt;  3 AZ        Arizona     West         Mountain          </span>
<span class="co">#&gt;  4 AR        Arkansas    South        West South Central</span>
<span class="co">#&gt;  5 CA        California  West         Pacific           </span>
<span class="co">#&gt;  6 CO        Colorado    West         Mountain          </span>
<span class="co">#&gt;  7 CT        Connecticut Northeast    New England       </span>
<span class="co">#&gt;  8 DE        Delaware    South        South Atlantic    </span>
<span class="co">#&gt;  9 FL        Florida     South        South Atlantic    </span>
<span class="co">#&gt; 10 GA        Georgia     South        South Atlantic    </span>
<span class="co">#&gt; # ... with 40 more rows</span></code></pre></div>
<p>Provide the associated label and <code>eia_geoset</code> recognizes subsets of US states. Even this can be a vector. In the example below, <code>region</code> consists of Alaska plus the states belonging to the New England census division.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eia_geoset.html">eia_geoset</a></span><span class="op">(</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AK"</span>, <span class="st">"New England"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 7 x 11</span>
<span class="co">#&gt;   geoset_id       setname                             f     units           series_id        name                                        region latlon start end   data        </span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;                               &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;                                       &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;list&gt;      </span>
<span class="co">#&gt; 1 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-AK~ Net generation : all fuels : Alaska : all ~ USA-AK &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 2 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-CT~ Net generation : all fuels : Connecticut :~ USA-CT &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 3 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-MA~ Net generation : all fuels : Massachusetts~ USA-MA &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 4 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-ME~ Net generation : all fuels : Maine : all s~ USA-ME &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 5 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-NH~ Net generation : all fuels : New Hampshire~ USA-NH &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 6 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-RI~ Net generation : all fuels : Rhode Island ~ USA-RI &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="co">#&gt; 7 ELEC.GEN.ALL-9~ Net generation : all fuels : all s~ A     thousand megaw~ ELEC.GEN.ALL-VT~ Net generation : all fuels : Vermont : all~ USA-VT &lt;NA&gt;   2001  2019  &lt;tibble [1 ~</span>
<span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   value date        year</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 6071. 2019-01-01  2019</span>

<span class="va">region</span> <span class="op">&lt;-</span> <span class="st">"Middle Atlantic"</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eia_geoset.html">eia_geoset</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">region</span>, n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">region</span>, <span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 36 x 4</span>
<span class="co">#&gt;    region  value date        year</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;</span>
<span class="co">#&gt;  1 USA-NJ 71019. 2019-01-01  2019</span>
<span class="co">#&gt;  2 USA-NJ 75034. 2018-01-01  2018</span>
<span class="co">#&gt;  3 USA-NJ 75645. 2017-01-01  2017</span>
<span class="co">#&gt;  4 USA-NJ 77611. 2016-01-01  2016</span>
<span class="co">#&gt;  5 USA-NJ 74609. 2015-01-01  2015</span>
<span class="co">#&gt;  6 USA-NJ 68051. 2014-01-01  2014</span>
<span class="co">#&gt;  7 USA-NJ 64751. 2013-01-01  2013</span>
<span class="co">#&gt;  8 USA-NJ 65263. 2012-01-01  2012</span>
<span class="co">#&gt;  9 USA-NJ 64694. 2011-01-01  2011</span>
<span class="co">#&gt; 10 USA-NJ 65682. 2010-01-01  2010</span>
<span class="co">#&gt; # ... with 26 more rows</span>

<span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">x</span>, cols <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">units</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, title <span class="op">=</span> <span class="st">"Net electricity generation"</span>, subtitle <span class="op">=</span> <span class="st">"From all fuels"</span><span class="op">)</span></code></pre></div>
<p><img src="geoset-geoset2-1.png" title="plot of chunk geoset2" alt="plot of chunk geoset2" width="100%"></p>
</div>
<div id="relations" class="section level2">
<h2 class="hasAnchor">
<a href="#relations" class="anchor"></a>Relations</h2>
<p>There is also a <code>relation</code> argument that accepts an optional relation ID. If one is provided, <code>eia_geoset</code> will switch to the API <code>relation</code> endpoint. A relation is another metadata structure that applies to geosets and relates summary statistics associated with geoset IDs to their composite statistics. This makes it easier to obtain variables that facet the data, e.g., by sector or fuel type.</p>
<p>The EIA <code>relation</code> API endpoint is officially supported according to the online EIA API documentation, but unfortunately that endpoint does not appear to function at the time of current package release.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/leonawicz">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
